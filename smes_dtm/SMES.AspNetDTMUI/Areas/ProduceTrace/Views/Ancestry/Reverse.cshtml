@{
    Layout = "~/Areas/ProduceTrace/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "生产追踪";


}

@section styles{
    @Styles.Render("~/Content/datepicker")
    <style>
        .querycontent {
            padding: 20px 0px 40px 0px;
            border-bottom: 1px solid #525358;
        }

            .querycontent .form-control {
                border-radius: 0px;
                -webkit-border-radius: 0px;
                -moz-border-radius: 0px;
                background-color: #e5e5e5;
            }

            .querycontent .btn {
                border-radius: 0px;
                -webkit-border-radius: 0px;
                -moz-border-radius: 0px;
            }

        .queryresult {
            /*background-color:red;*/
            margin-top: 10px;
        }

        .tree {
            list-style: none;
            font-size: 16px;
            color: #c5c5c5;
        }

            .tree > li {
                margin-bottom: 20px;
            }

                .tree > li > ul {
                    font-size: 14px;
                    list-style: none;
                    margin-left: 0px;
                    padding-left: 20px;
                    color: #999;
                }

                    .tree > li > ul > li {
                        margin: 4px 0px;
                    }

            .tree a {
                color: #999;
                outline: none;
                text-decoration: none;
            }

                .tree a:hover {
                    color: #579be6;
                }

        .active {
            color: #579be6 !important;
        }

        .suminfo {
            padding: 20px 0px;
            border-bottom: 1px solid #525358;
            margin: 0px 10px 20px 10px !important;
        }

            .suminfo .module {
                height: 84px;
                /*background-color:red;*/
                margin-left: -10px;
                margin-right: -10px;
                overflow: hidden;
                color: #999;
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
            }

                .suminfo .module div {
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                }

                .suminfo .module.header {
                    border-right: 1px solid #525358;
                    position: relative;
                }


        .headerbtn {
            position: absolute;
            right: 5px;
            bottom: 0px;
            padding: 0px;
            margin: 0px;
            text-align: center;
            height: 22px;
            width: 22px;
            line-height: 22px;
            border: 1px solid #525358;
            border-radius: 100%;
        }

            .headerbtn:hover,
            .headerbtn:focus {
                color: #fff;
            }

        .suminfo .module.header .title {
            font-size: 18px;
            color: #fff;
            margin-bottom: 10px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .module .number {
            font-size: 36px;
            margin: 10px 0px;
            color: #fff;
            font-family: "Open Sans";
        }


        .gyzinfo {
            height: 440px;
            margin: 0px 10px 0px 10px !important;
        }

        .gyzinfodiv {
            float: left;
            /*line-height:440px;*/
        }

        .gyzinfo .module {
            /*line-height:none;*/
            /*height: 220px;*/
            /*background-color:red;*/
            margin-left: 0px;
            margin-right: 0px;
            overflow: hidden;
            color: #999;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #fff;
        }

            .gyzinfo .module div {
                white-space: nowrap;
                overflow: hidden;
                text-overflow: ellipsis;
                color: #fff;
            }

            .gyzinfo .module .title {
                background-color: rgba(0,0,0,0.2);
                padding: 4px 4px 4px 20px;
            }

                .gyzinfo .module .title > .btn {
                    color: #fff;
                    padding: 0px;
                    margin: 0px;
                }

                    .gyzinfo .module .title > .btn:hover {
                        color: #579be6;
                    }

            .gyzinfo .module .module-content {
                padding: 20px;
                font-size: 12px;
            }

                .gyzinfo .module .module-content > div {
                    line-height: 2;
                }

                    .gyzinfo .module .module-content > div > span {
                        color: rgba(0,0,0,0.6);
                        font-size: 24px;
                        font-family: "Open Sans";
                        font-style: italic;
                    }

        .small-font {
            font-size: 12px;
        }

        .gyz-mx-batch {
            font-size: 24px;
            color: #579ce9;
        }

        .gyz-mx-big-font {
            margin-top: 5px;
            font-size: 48px;
            color: #43b9df;
        }

        .gyz-mx-small-font {
            margin-top: 5px;
            font-size: 14px;
            color: #43b9df;
        }

        .table-extent {
        }

            .table-extent th {
                color: #333;
                font-weight: normal;
            }

            .table-extent td {
                border: 0px !important;
            }

            .table-extent thead > tr > th {
                border-top: 1px solid #dddddd !important;
                border-bottom: 1px solid #dddddd;
            }

        .tablebodydiv {
            height: 150px;
        }

            .tablebodydiv table {
                margin: 0px;
            }

        .radiobtn {
            color: #fafafa;
        }

            .radiobtn:hover {
                color: #579be6;
            }

            .radiobtn > .round1 {
                height: 12px;
                width: 12px;
                border-radius: 16px;
                border: 2px solid #579be6;
                display: inline-block;
                margin-right: 4px;
                /*text-align:center;
            line-height:12px;*/
            }

                .radiobtn > .round1 > .round2 {
                    height: 6px;
                    width: 6px;
                    border-radius: 6px;
                    margin-left: 1px;
                    margin-top: 1px;
                }

            .radiobtn.checked > .round1 > .round2 {
                background-color: #579be6;
            }

            .radiobtn > .text {
                line-height: 14px;
                display: inline-block;
            }

        .jconfirm-scrollpane {
            color: #000;
        }

        .summary_l_d1 {
            border-bottom: 1px solid #525358;
            padding-bottom: 5px;
            font-size: 18px;
        }

        .summary_l_nav li {
            width: 79px;
            line-height: 20px;
            height: 20px;
            /*border-bottom: 4px solid #525358;*/
            text-align: center;
        }

            .summary_l_nav li:hover {
                border-bottom: 4px solid #6497D0;
                color: #6497D0;
            }

        .cd {
            border-bottom: 4px solid #6497D0;
            color: #6497D0;
        }

        .ncd {
            border-bottom: 4px solid #525358;
        }

        .hd {
            display: none;
        }
    </style>

}
<div class="content1">
    @*<div id="scroll">
            <div id="sss" style="height:1000px;position:relative">
            </div>
        </div>*@
    <input id="backinput" type="hidden" value="" />
    <div class="left">
        <div class="querycontent">
            <form>
                <div class="form-group row" style="border-bottom: 1px solid #525358">
                    <div class="col-xs-6">
                        <div class="btn radiobtn" id="Positive">
                            <div class="round1">
                                <div class="round2"></div>
                            </div>
                            <div class="text">
                                正向追踪
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-6">
                        <div class="btn radiobtn checked" id="Reverse">
                            <div class="round1">
                                <div class="round2"></div>
                            </div>
                            <div class="text">
                                反向追踪
                            </div>
                        </div>
                    </div>
                </div>
                <ul class="nav nav-pills summary_l_nav">
                    <li class="cd">日期选择</li>
                    <li class="ncd">钢印号</li>
                    <li class="ncd">一号工程码</li>
                </ul>
                <div id="ds">
                    <div class="form-group" style="margin-top:10px;">
                        <input id="date" type="text" class="form-control datepicker-here" />
                    </div>

                    <div class="form-group">
                        @*<input id="txtteam" type="text" class="form-control" placeholder="班组" />*@

                        <select class="form-control" id="txtteam">
                            <option value="">全部班组</option>
                            <option value="甲班">甲班</option>
                            <option value="乙班">乙班</option>
                            <option value="丙班">丙班</option>
                        </select>
                    </div>
                    <div class="form-group">
                        @*<input id="txtmat" type="text" class="form-control" placeholder="牌号" />*@
                        <select class="form-control" id="txtmat">
                            <option value="">全部牌号</option>
                        </select>
                    </div>
                </div>
                <div id="hs" class="hd">
                    <div class="form-group" style="margin-top:10px;">
                        <input id="txtStamp" type="text" class="form-control" placeholder="钢印号" />
                    </div>
                </div>
                <div id="ms" class="hd">
                    <div class="form-group" style="margin-top:10px;">
                        <input id="txtCodeone" type="text" class="form-control" placeholder="一号工程码" />
                    </div>
                </div>
                <div class="btn btn-primary btn-block" onclick='QueryCutBatchInfo();'>查询</div>
            </form>
        </div>

        <div id="queryresult" class="queryresult">
            <ul id="tree" class="tree"></ul>
        </div>
    </div>

    <div class="main">
        <div id="Scroll2">
            <div class="suminfo row">
                <div class="col-xs-2">
                    <div id="batchinfo" class="module header">
                    </div>
                </div>
                <div class="col-xs-10">
                    <div class="col-xs-3">
                        <div class="module">
                            产成品量（箱）
                            <div id="productqty" class="number" style="color:#ffb216">0</div>
                        </div>
                    </div>
                    <div class="col-xs-3">
                        <div class="module">
                            耗烟丝量（公斤）
                            <div id="inputqty" class="number"></div>
                        </div>
                    </div>
                    <div class="col-xs-3">
                        <div class="module">
                            缺陷数量
                            <div id="qlscore" class="number">0</div>
                        </div>
                    </div>
                    <div class="col-xs-3">
                        <div class="module">
                            质量得分
                            <div id="qascore" class="number">0</div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="gyzinfo" class="gyzinfo row">

            </div>
        </div>


    </div>
</div>
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">投料信息页</h4>
            </div>
            <div class="modal-body">
                <div id="tlwoinfo" class="row row-margin">

                </div>

                <div class="row row-margin">
                    <table class="table table-hover table-extent" style="margin-bottom:0px;">
                        <thead>
                            <tr>
                                <th style="width:5%">
                                    <i class="icon-stop"></i>
                                </th>
                                <th style="width:22%">
                                    物料
                                </th>
                                <th style="width:22%">
                                    编码
                                </th>
                                <th style="width:22%">
                                    投料量(Kg)
                                </th>
                                <th style="width:24%">
                                    批次号
                                </th>
                            </tr>
                        </thead>
                    </table>

                    <div class="tablebodydiv">
                        <div id="scortable">
                            <table class="table table-hover table-extent">
                                <tbody id="tllist"></tbody>
                            </table>
                        </div>

                    </div>

                </div>
            </div>
        </div>
    </div>
</div>


@section scripts{

    @Scripts.Render("~/bundles/datepicker")

    <script>
        var tp = 0;
        $(".summary_l_nav li").click(function () {

            $(".summary_l_nav li").removeClass("cd");
            $(".summary_l_nav li").addClass("ncd");
            $(this).removeClass("ncd");
            $(this).addClass("cd");

            if ($(this).text() == '钢印号') {
                $('#ds').addClass("hd");
                $('#hs').removeClass("hd");
                $('#ms').addClass("hd");
                tp = 1;
            }
            else if ($(this).text() == '一号工程码') {
                $('#ds').addClass("hd");
                $('#hs').addClass("hd");
                $('#ms').removeClass("hd");
                tp = 2;
            }
            else {
                $('#ds').removeClass("hd");
                $('#hs').addClass("hd");
                $('#ms').addClass("hd");
                tp = 0;
            }
        });
        $('#date').change(function () {
            bindMat();
        });
        $('#Positive').click(function () {
            window.location = "Index";
        });

        function setsize() {
            var heigth = $(".left").height() - 70 - $(".querycontent").height();
            $("#queryresult").height(heigth);
        }

        $(function () {
            resiz();
            $(window).on("resize", resiz);

            if ($("#backinput").val() == "") {
                $("#date").val(new Date().Format("yyyy-MM-dd"));

                $(".form-group .radiobtn").click(function () {
                    if ($(this).hasClass("checked"))
                        return;

                    $(".form-group").find(".checked").removeClass("checked");

                    $(this).addClass("checked");
                })
                bindMat();
                QueryCutBatchInfo();

                $("#backinput").val("true");

            }


        })


        function resiz() {
            setsize();
            setScroll1();
            setScroll2();
            setScroll3();
        }

        function setScroll1() {
            $("#tree").slimScroll({
                height: $(".queryresult").height(),
                alwaysVisible: false,
                color: "#38393d",
                railColor: "#525357",
                railOpacity: 1,
                railVisible: true,
                disableFadeOut: true
            });
        }

        function setScroll2() {
            $("#Scroll2").slimScroll({
                height: $(".main").height(),
                alwaysVisible: false,
                color: "#38393d",
                railColor: "#525357",
                railOpacity: 1,
                railVisible: true,
                disableFadeOut: true
            });
        }

        function setScroll3() {
            $("#scortable").slimScroll({
                height: 150,
                alwaysVisible: false,
                color: "#e7eefe",
                railColor: "#e4e5e9",
                railOpacity: 1,
                railVisible: true,
                disableFadeOut: true
            });
        }

        function setTree() {
            $("#tree a").click(function () {

                if ($(this).hasClass("active"))
                    return;

                var batch = $(this).tmplItem().data;

                $("#tree .active").removeClass("active");
                $(this).addClass("active");
                BatchInfo(batch);
                woinfo(batch);
                return false;
            })

            $("#tree a").first().click();
        }

        function bindMat() {
            $('#txtmat').html('');
            $('#txtmat').append('<option value="">全部牌号</option>');
            //debugger;
            var date = $("#date").val();
            app.DataRequest('@Url.Action("QueryPackMatInfo")', { plandate: date }, function (data) {

                data.forEach(function (value, index) {
                    //value.PRODUCTID
                    $('#txtmat').append('<option value="' + value.PRODUCTNAME + '">' + value.PRODUCTNAME + '</option>');
                })
            })
        }

        //$(window).on("resize", setScroll);

        /*********业务数据获取**********/

        //var curBatch;

        function QueryCutBatchInfo() {

            $('#batchinfo').html('');
            //debugger;
            var date = $("#date").val();
            var tm = $("#txtteam option:selected").val();
            var pro = $("#txtmat option:selected").val();
            var gy = $("#txtStamp").val();
            var cd = $("#txtCodeone").val();
            app.DataRequest('@Url.Action("QueryPackBatchInfo")', { plandate: date, team: tm, product: pro, stamp: gy, codeone: cd, type: tp }, function (data) {

                var groupdatadic = [];

                data.forEach(function (value, index) {
                    if (groupdatadic["ID" + value.PRODUCTID + value.TEAMID])
                        groupdatadic["ID" + value.PRODUCTID + value.TEAMID].Child.push(value);
                    else
                        groupdatadic["ID" + value.PRODUCTID + value.TEAMID] = { ID: value.PRODUCTID, Name: value.TEAMNAME + '-' + value.PRODUCTNAME, Child: [value] };

                })

                var groupdata = [];

                for (var item in groupdatadic) {
                    groupdata.push(groupdatadic[item]);
                }

                $("#tree").empty();
                $("#producttmpl").tmpl(groupdata).appendTo("#tree");
                setTree();
                setScroll1();

            });
        }

        //批次信息
        function BatchInfo(batch) {
            $("#batchinfo").empty();
            $("#batchinfotmpl").tmpl(batch).appendTo("#batchinfo");

            $('#productqty').html('0');
            $('#inputqty').html('0');
            $('#outputqty').html('');
            $('#qlscore').html('0');
            $('#qascore').html('');
            app.DataRequest('@Url.Action("QueryPackSumInfo")', { plancode: batch.PLANCODE, teamid: batch.TEAMID, plandate: batch.PLANDATE }, function (data) {

                data.forEach(function (value, index) {
                    $('#productqty').html(value.PRODUCTQTY);
                    $('#inputqty').html(value.COSTQTY);
                    $('#qlscore').html(value.FAULTQTY);
                    $('#qascore').html(decimal(value.QASCORE,3));
                })
            })
        }

        function woinfo(batch) {
            //debugger;
            app.DataRequest('@Url.Action("QueryPackWoInfo")', { plancode: batch.PLANCODE, teamid: batch.TEAMID, plandate: batch.PLANDATE }, function (data) {

                var tmpwsj = [];
                var tmpjjj = [];
                var tmpbzj = [];
                var tmpfzxj = [];
                //debugger;

                data.forEach(function (item, index) {
                    //debugger;
                    if (tmpwsj["WSJ" + item.WSJRSID]) {
                        var ct = tmpwsj["WSJ" + item.WSJRSID].CT + 1;
                        tmpwsj["WSJ" + item.WSJRSID].CT=(ct)
                    }
                    else {
                        tmpwsj["WSJ" + item.WSJRSID] = { CT: 1, NM: item.WSJRSNM, TEAMNAME: item.TEAMNAME, WO: item.WSJCODE};
                    }

                    if (tmpjjj["JJJ" + item.JJJRSID]) {
                        var ct = tmpjjj["JJJ" + item.JJJRSID].CT + 1;
                        tmpjjj["JJJ" + item.JJJRSID].CT=(ct)
                    }
                    else {
                        tmpjjj["JJJ" + item.JJJRSID] = { CT: 1, NM: item.JJJRSNM, TEAMNAME: item.TEAMNAME, WO: item.JJJCODE };
                    }

                    if (tmpbzj["BZJ" + item.BZJRSID]) {
                        var ct = tmpbzj["BZJ" + item.BZJRSID].CT + 1;
                        tmpbzj["BZJ" + item.BZJRSID].CT=(ct)
                    }
                    else {
                        tmpbzj["BZJ" + item.BZJRSID] = { CT: 1, NM: item.BZJRSNM, TEAMNAME: item.TEAMNAME, WO: item.BZJCODE };
                    }

                    if (tmpfzxj["FZXJ" + item.FZXJRSID]) {
                        var ct = tmpfzxj["FZXJ" + item.FZXJRSID].CT + 1;
                        tmpfzxj["FZXJ" + item.FZXJRSID].CT = (ct)
                    }
                    else {
                        tmpfzxj["FZXJ" + item.FZXJRSID] = { CT: 1, NM: item.FZXJRSNM, TEAMNAME: item.TEAMNAME, WO: item.FZXJCODE };
                    }

                });

                //var groupdata = [];
                //for (var item in tmpgroup) {
                //    groupdata.push(tmpgroup[item]);
                //}
                var ht = 220;//基础单元高度
                $("#gyzinfo").empty();
                var wsjlist = gethtmlwsj(tmpwsj, '#F76532', ht, batch);
                $("#gyzinfo").append(wsjlist);
                
                var jjjlist = gethtmljjj(tmpjjj, '#FFB319', ht, batch);
                $("#gyzinfo").append(jjjlist);

                var bzjlist = gethtmlbzj(tmpbzj, '#09CC52', ht, batch);
                $("#gyzinfo").append(bzjlist);

                var fzxjlist = gethtmlfzxj(tmpfzxj, '#579BE6', ht, batch);
                $("#gyzinfo").append(fzxjlist);

            });
        }

        function gethtmlwsj(tmp, cl, ht, batch) {
            var a = '<div class="gyzinfodiv" style="width:25%;background-color:' + cl + ';">';
            for (var item in tmp) {
                var ws = 0;
                var hs = 0;
                var matlot = '';
                app.DataRequest('@Url.Action("QueryFeedWoInfo")', { plancode: batch.PLANCODE, teamid: batch.TEAMID, plandate: batch.PLANDATE, feedwo: tmp[item].WO }, function (data) {

                    data.forEach(function (item, index) {
                        ws = item.XHQTY;
                        hs = item.CHQTY;
                        matlot += '<div><a style="color:#e5e5e5;font-size:12px;" href="#">' + item.MATLOT + '</a></div>';
                    });
                }, null, false);

                a += '<div class="module" style="height:' + tmp[item].CT * ht + 'px;">';
                a += '<div class="title">';
                a += '<a class="btn infobtn" href="#">' + tmp[item].NM + '</a>';
                a += '</div>';
                a += '<div class="module-content">';
                //a += '<div>班组：' + tmp[item].TEAMNAME + '</div>';
                a += '<div>喂丝量：'+decimal(ws,3)+' 公斤</div>';
                a += '<div>耗丝量：' + decimal(hs, 3) + ' 公斤/箱</div>';
                a += '<div>烟丝批次：</div>';
                a += matlot;
                a += '</div>';
                a += '</div>';
            }
            a += '</div>';
            return a;
        }

        function gethtmljjj(tmp, cl, ht, batch) {
            var a = '<div class="gyzinfodiv" style="width:25%;background-color:' + cl + ';">';
            for (var item in tmp) {
                var cc = 0;
                var qx = 0;
                var ch = 0;
                app.DataRequest('@Url.Action("QueryEQUInfo")', { plancode: batch.PLANCODE, teamid: batch.TEAMID, plandate: batch.PLANDATE, typeid: 432, pronm: tmp[item].NM }, function (data) {

                    data.forEach(function (item, index) {
                        debugger;
                        cc = item.CCQTY;
                        qx = item.QXQTY;
                        ch = item.CHQTY;
                    });
                },null,false);

                a += '<div class="module" style="height:' + tmp[item].CT * ht + 'px;">';
                a += '<div class="title">';
                a += '<a class="btn infobtn" href="#">' + tmp[item].NM + '</a>';
                a += '</div>';
                a += '<div class="module-content">';
                //a += '<div>班组：' + tmp[item].TEAMNAME + '</div>';
                a += '<div>产出量：' + cc + ' 万支</div>';
                a += '<div>盘纸单耗：' + decimal(ch / 10000,3) + ' 米/万支</div>';
                a += '<div>缺陷量：' + qx + ' 万支</div>';
                a += '<div>剔除量：xxx</div>';
                a += '</div>';
                a += '</div>';
            }
            a += '</div>';
            return a;
        }

        function gethtmlbzj(tmp, cl, ht, batch) {

            var a = '<div class="gyzinfodiv" style="width:25%;background-color:' + cl + ';">';
            for (var item in tmp) {
                var cc = 0;
                var qx = 0;
                var ch = 0;
                app.DataRequest('@Url.Action("QueryEQUInfo")', { plancode: batch.PLANCODE, teamid: batch.TEAMID, plandate: batch.PLANDATE, typeid: 440, pronm: tmp[item].NM }, function (data) {

                    data.forEach(function (item, index) {
                        debugger;
                        cc = item.CCQTY;
                        qx = item.QXQTY;
                        ch = item.CHQTY;
                    });
                }, null, false);

                a += '<div class="module" style="height:' + tmp[item].CT * ht + 'px;">';
                a += '<div class="title">';
                a += '<a class="btn infobtn" href="#">' + tmp[item].NM + '</a>';
                a += '</div>';
                a += '<div class="module-content">';
                //a += '<div>班组：' + tmp[item].TEAMNAME + '</div>';
                a += '<div>产出量：' + cc + ' 万支</div>';
                a += '<div>商标纸单耗：' + ch + ' 张/万支</div>';
                a += '<div>缺陷量：' + qx + ' 万支</div>';
                a += '<div>剔除量：xxx</div>';
                a += '</div>';
                a += '</div>';
            }
            a += '</div>';
            return a;
        }

        function gethtmlfzxj(tmp, cl, ht, batch) {
            var a = '<div class="gyzinfodiv" style="width:25%;background-color:' + cl + ';">';
            for (var item in tmp) {
                var cc = 0;
                var qx = 0;
                var ch = 0;
                app.DataRequest('@Url.Action("QueryEQUInfo")', { plancode: batch.PLANCODE, teamid: batch.TEAMID, plandate: batch.PLANDATE, typeid: 439, pronm: tmp[item].NM }, function (data) {

                    data.forEach(function (item, index) {
                        debugger;
                        cc = item.CCQTY;
                        qx = item.QXQTY;
                        ch = item.CHQTY;
                    });
                }, null, false);
                a += '<div class="module" style="height:' + tmp[item].CT * ht + 'px;">';
                a += '<div class="title">';
                a += '<a class="btn infobtn" href="#">' + tmp[item].NM + '</a>';
                a += '</div>';
                a += '<div class="module-content">';
                //a += '<div>班组：' + tmp[item].TEAMNAME + '</div>';
                a += '<div>产出量：' + cc + ' 万支</div>';
                a += '<div>箱皮单耗：' + decimal(ch / 10000, 3) + '</div>';
                a += '<div>缺陷量：' + qx + ' 万支</div>';
                a += '<div>剔除量：xxx</div>';
                a += '</div>';
                a += '</div>';
            }
            a += '</div>';
            return a;
        }

        function decimal(num, v) {
            var vv = Math.pow(10, v);
            return Math.round(num * vv) / vv;
        }

        function closeframe() {

            $("#produceprocessinfo").hide(300, function () {
                $("#produceprocessinfo").remove();
            });
        }
    </script>
    <script id="producttmpl" type="text/x-jquery-tmpl">
        <li>
            ${Name}
            <ul>
                {{tmpl(Child) "#batchtmpl"}}
            </ul>
        </li>
    </script>

    <script id="batchtmpl" type="text/x-jquery-tmpl">
        <li><a href="#">${PLANCODE}</a></li>
    </script>

    <script id="batchinfotmpl" type="text/x-jquery-tmpl">
        <div class="title">${PRODUCTNAME}</div>
        <div>作业号:${PLANCODE}</div>
        <div>日期:${PLANDATE}</div>
        <div>班组:${TEAMNAME}</div>

        <div class="btn headerbtn">
            <i class="icon-share-alt icon-rotate-180"></i>
        </div>
    </script>

    <script id="storelisttmpl" type="text/x-jquery-tmpl">
        <div class="gyzinfodiv" style="background-color:${$item.getColor()}">
            {{tmpl(ORDERS) "#storeinfotmpl"}}
        </div>
    </script>

    <script id="storeinfotmpl" type="text/x-jquery-tmpl">
        <div class="module" >
            <div class="title">
                <a class="btn infobtn" href='#'>${NM}</a>
            </div>
            <div class="module-content">
                <div>班组：${TEAMNAME}</div>
                <div>得分：<span>0</span></div>
            </div>
        </div>
    </script>

    <script id="tlwoinfotmpl" type="text/x-jquery-tmpl">
        <div class="col-xs-5">
            <div class="col-margin">
                <div class="small-font">开始：${$item.datefrm(REALSTARTTIME,"yyyy-MM-dd HH:mm")}  结束：${$item.datefrm(REALENDTIME,"yyyy-MM-dd HH:mm")}</div>
                <div class="gyz-mx-batch">批次：${BATCHCODE}</div>
                <div>班组：<span style="color:#333">${TEAMNAME}</span></div>
                <div>班次：<span style="color:#333">${SHIFTNAME}</span></div>
            </div>
        </div>
        <div class="col-xs-2">
            <div class="col-margin">
                模块号
                <div class="gyz-mx-small-font">
                    {{if MODULENAME}}
                    ${MODULENAME}
                    {{else}}
                    --
                    {{/if}}
                </div>
            </div>

        </div>
        <div class="col-xs-3">
            <div class="col-margin">
                批次投料量(公斤)
                <div class="gyz-mx-big-font">
                    ${INPUTQTY}
                </div>
            </div>
        </div>
        <div class="col-xs-2">
            <div class="col-margin">
                投入产出比
                <div class="gyz-mx-big-font">
                    ${$item.getRate(INPUTQTY,QUANTITY)}
                </div>
            </div>
        </div>
    </script>

    <script id="tllisttmpl" type="text/x-jquery-tmpl">
        <tr>
            <td style="width:5%">
                <i class="icon-stop"></i>
            </td>
            <td style="width:22%">
                ${MATERIALNAME}
            </td>
            <td style="width:22%">
                ${MATERIALCD}
            </td>
            <td style="width:22%">
                ${QUANTITY}
            </td>
            <td style="width:24%">
                ${MATLOT}
            </td>
        </tr>
    </script>
}
